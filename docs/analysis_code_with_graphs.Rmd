---
title: "Data Scientist Skills"
author: "Marley Myrianthopoulos"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


**1. Compiled and cleaned a list of data science skills:**
```{r}
library(tidyr)
library(tidyverse)
library(dplyr)

data_scientist_skills_list <- read.csv("https://raw.githubusercontent.com/samato0624/DATA607_Project3/main/docs/data_scientist_skills.csv")

data_scientist_skills_list <- data_scientist_skills_list[-1,]

unique_skills_list <- data.frame(skills_list = unlist(data_scientist_skills_list))

unique_skills_list <- unique_skills_list %>%
  filter(skills_list != "") %>%
  group_by(skills_list) %>%
  mutate(count = length(skills_list)) %>%
  distinct(skills_list,count) %>%
  arrange(desc(count), skills_list)
  
rownames(unique_skills_list) <- NULL

final_skills_list <- unique_skills_list[c(1:9,12,13,17,19,22,24,27:29,32,34,36:37,39,40,43,45,47:50,52,53,58,59,61,62,64,66,71,72,76,77,79:81,83:87),1]

final_skills_list <- final_skills_list %>% arrange(skills_list)

final_skills_list$skills_list <- tolower(final_skills_list$skills_list)

final_skills_list$skills_list[38] <- " r "

final_skills_list
```

**2. Compiled and cleaned a list of data science job postings:** 
```{r}
raw_data <- read.csv("https://raw.githubusercontent.com/samato0624/DATA607_Project3/main/Raw_Data.csv")

job_posts <- raw_data %>%
  
  # removed unwanted characters
  mutate(Pay.Range = (str_remove_all(Pay.Range, "[$yr////, ]"))) %>%
  
  # extracted min salary from pay range column
  mutate(Pay_Min = as.numeric(str_extract(Pay.Range, "\\d+(?=-)"))) %>%
  # extracted max salary from pay range column
  mutate(Pay_Max = as.numeric(str_extract(Pay.Range, "(?<=-)[0-9]+"))) %>%
  
  # selected only necessary columns
  select(c(2, 3, 5, 6, 7, 8))

job_posts
```

**3. Analyzed the job_posts for counts of items found in skills_list:**
```{r}
skills_data <- final_skills_list


for(i in 1:nrow(skills_data)) {
  skills_data$postings[i] <- as.numeric(job_posts %>% filter(str_detect(tolower(About.the.job),skills_data$skills_list[i])) %>% summarise(n = n()))
}

skills_data <- skills_data %>% filter(postings != 0)

for(i in 1:nrow(skills_data)) {
  skills_data$avg_min_sal[i] <- as.numeric(job_posts %>% drop_na(Pay_Min) %>% filter(str_detect(tolower(About.the.job),skills_data$skills_list[i])) %>% summarise(avg = mean(Pay_Min)))
}

skills_data_postings <- skills_data %>% arrange(desc(postings))
skills_data_postings

skills_data_sal <- skills_data %>% filter(postings >= 5) %>% arrange(desc(avg_min_sal))
skills_data_sal
```

**4. Visualized counts data:**
```{r}
skills_data_sal$skills_list <- factor(skills_data_sal$skills_list, levels = skills_data_sal$skills_list[order(skills_data_sal$postings, decreasing = FALSE)])

ggplot(skills_data_sal, aes(x = skills_list, y = postings, fill = skills_list)) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  labs(title = "Number of Postings by Skill", x = "Skill", y = "Frequency") +
  coord_flip() 
```


```{r}
skills_data_sal$skills_list <- factor(skills_data_sal$skills_list, levels = skills_data_sal$skills_list[order(skills_data_sal$avg_min_sal, decreasing = FALSE)])

ggplot(skills_data_sal, aes(x = skills_list, y = avg_min_sal, fill = skills_list)) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  labs(title = "Average Minimum Salary by Skill", x = "Skill", y = "Average Minimum Salary (dollars per year)") +
  coord_flip()
```
To analyze which skills are the most valuable by salary, we are going to focus on the minimum of the given salary range for each posting. When a skill is particularly highly valued, the minimum salary in the range would not go below a certain amount. The inverse, however, is not necessarily true. For a skill that is not particularly highly valued, we cannot assume that the maximum salary would not go above a certain amount. Skills that are not as highly valued are likely to be considered baseline requirements that would appear in job postings for higher-paying as well as lower-paying jobs, making the maximum salary in the range less meaningful for comparison than the minimum salary. 


